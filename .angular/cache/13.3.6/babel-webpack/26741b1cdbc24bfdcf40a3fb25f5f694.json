{"ast":null,"code":"import _asyncToGenerator from \"E:\\\\WE4B\\\\boooooooooooooooooooof\\\\project\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Restaurant } from './../../class/restaurant';\nimport { Component } from '@angular/core';\nimport { Validators } from '@angular/forms';\nlet AddrestaurantComponent = class AddrestaurantComponent {\n  constructor(service, servCate, formBuilder, router) {\n    this.service = service;\n    this.servCate = servCate;\n    this.formBuilder = formBuilder;\n    this.router = router;\n    this.addrestaurantForm = this.formBuilder.group({\n      nom: ['', Validators.required],\n      description: ['', Validators.required],\n      codepostale: ['', Validators.required],\n      adresse: ['', Validators.required]\n    });\n    this.restaurant = new Restaurant(this.service.list_length + 1, this.addrestaurantForm.value.nom, this.addrestaurantForm.value.description, this.addrestaurantForm.value.adresse, this.addrestaurantForm.value.codepostale, 0, 0, undefined);\n    this.servCate.getData().subscribe(data => {\n      this.categorie = data.splice(1);\n    });\n  }\n\n  ngOnInit() {}\n\n  addRestaurant() {\n    this.service.addRestaurant(Object.assign(Object.assign({}, this.restaurant), this.addrestaurantForm.value)).subscribe(data => {\n      this.restaurant = data;\n    });\n    this.router.navigateByUrl('/restaurant-list');\n  }\n\n  onFileSelected(event) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      _this.selectedFile = event.target.files[0];\n      const {\n        name\n      } = _this.selectedFile;\n\n      if (!_this.isImage(name)) {\n        alert(\"Fichier non supporté\");\n        return;\n      }\n\n      _this.restaurant.img = yield _this.fileToBase64(_this.selectedFile);\n    })();\n  }\n\n  isImage(name) {\n    const ext = name.split(\".\").reverse()[0];\n    return [\"jpg\", \"jpeg\", \"png\"].includes(ext);\n  }\n\n  fileToBase64(file) {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.readAsDataURL(file);\n\n      reader.onload = () => resolve(reader.result);\n\n      reader.onerror = error => reject(error);\n    });\n  }\n\n};\nAddrestaurantComponent = __decorate([Component({\n  selector: 'app-addrestaurant',\n  templateUrl: './addrestaurant.component.html',\n  styleUrls: ['./addrestaurant.component.css']\n})], AddrestaurantComponent);\nexport { AddrestaurantComponent };","map":{"version":3,"sources":["E:/WE4B/boooooooooooooooooooof/project/src/app/admin/addrestaurant/addrestaurant.component.ts"],"names":["__decorate","Restaurant","Component","Validators","AddrestaurantComponent","constructor","service","servCate","formBuilder","router","addrestaurantForm","group","nom","required","description","codepostale","adresse","restaurant","list_length","value","undefined","getData","subscribe","data","categorie","splice","ngOnInit","addRestaurant","Object","assign","navigateByUrl","onFileSelected","event","selectedFile","target","files","name","isImage","alert","img","fileToBase64","ext","split","reverse","includes","file","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","error","selector","templateUrl","styleUrls"],"mappings":"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","sourcesContent":["import { __decorate } from \"tslib\";\r\nimport { Restaurant } from './../../class/restaurant';\r\nimport { Component } from '@angular/core';\r\nimport { Validators } from '@angular/forms';\r\nlet AddrestaurantComponent = class AddrestaurantComponent {\r\n    constructor(service, servCate, formBuilder, router) {\r\n        this.service = service;\r\n        this.servCate = servCate;\r\n        this.formBuilder = formBuilder;\r\n        this.router = router;\r\n        this.addrestaurantForm = this.formBuilder.group({\r\n            nom: ['', Validators.required],\r\n            description: ['', Validators.required],\r\n            codepostale: ['', Validators.required],\r\n            adresse: ['', Validators.required],\r\n        });\r\n        this.restaurant = new Restaurant(this.service.list_length + 1, this.addrestaurantForm.value.nom, this.addrestaurantForm.value.description, this.addrestaurantForm.value.adresse, this.addrestaurantForm.value.codepostale, 0, 0, undefined);\r\n        this.servCate.getData().subscribe(data => {\r\n            this.categorie = data.splice(1);\r\n        });\r\n    }\r\n    ngOnInit() {\r\n    }\r\n    addRestaurant() {\r\n        this.service.addRestaurant(Object.assign(Object.assign({}, this.restaurant), this.addrestaurantForm.value)).subscribe((data) => {\r\n            this.restaurant = data;\r\n        });\r\n        this.router.navigateByUrl('/restaurant-list');\r\n    }\r\n    async onFileSelected(event) {\r\n        this.selectedFile = event.target.files[0];\r\n        const { name } = this.selectedFile;\r\n        if (!this.isImage(name)) {\r\n            alert(\"Fichier non supporté\");\r\n            return;\r\n        }\r\n        this.restaurant.img = await this.fileToBase64(this.selectedFile);\r\n    }\r\n    isImage(name) {\r\n        const ext = name.split(\".\").reverse()[0];\r\n        return [\"jpg\", \"jpeg\", \"png\"].includes(ext);\r\n    }\r\n    fileToBase64(file) {\r\n        return new Promise((resolve, reject) => {\r\n            const reader = new FileReader();\r\n            reader.readAsDataURL(file);\r\n            reader.onload = () => resolve(reader.result);\r\n            reader.onerror = error => reject(error);\r\n        });\r\n    }\r\n};\r\nAddrestaurantComponent = __decorate([\r\n    Component({\r\n        selector: 'app-addrestaurant',\r\n        templateUrl: './addrestaurant.component.html',\r\n        styleUrls: ['./addrestaurant.component.css']\r\n    })\r\n], AddrestaurantComponent);\r\nexport { AddrestaurantComponent };\r\n"]},"metadata":{},"sourceType":"module"}